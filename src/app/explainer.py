"""
–ú–æ–¥—É–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —á–µ—Ä–µ–∑ YandexGPT Responses API.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—é –æ–±—ä—è—Å–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ YandexGPT Responses API (OpenAI compatible)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- Fallback –Ω–∞ —à–∞–±–ª–æ–Ω—ã, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
"""

import os
import hashlib
import json
from typing import Dict, Optional

from src.utils.yandex_cloud import get_cached_config


# –ö—ç—à –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π (–≤ –ø–∞–º—è—Ç–∏)
_explanation_cache: Dict[str, str] = {}


def build_prompt(profile: Dict, product: str) -> str:
    """
    –°—Ç—Ä–æ–∏—Ç –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è YandexGPT (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤).
    
    :param profile: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä–µ–≥–∏–æ–Ω, avg_tx, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ —Ç.–¥.)
    :param product: –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞
    :return: –¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞ (—Å–∂–∞—Ç—ã–π)
    """
    # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–º–∏–Ω–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤)
    avg_tx = profile.get("avg_tx", 0)
    num_payments = profile.get("num_payments", 0)
    
    # –ö–∞—Ç–µ–≥–æ—Ä–∏—è (—Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞, —Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è)
    top_brand_category = profile.get("top_brand_category")
    top_category = profile.get("top_category")
    category = top_brand_category or top_category or ""
    
    # –°–∂–∞—Ç—ã–π —Ñ–æ—Ä–º–∞—Ç: —Ç–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
    prompt = f"–ö–ª–∏–µ–Ω—Ç: —á–µ–∫ ${avg_tx:.0f}, –ø–ª–∞—Ç–µ–∂–µ–π {num_payments}"
    if category:
        # –°–æ–∫—Ä–∞—â–∞–µ–º –¥–ª–∏–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        cat_short = category[:30] if len(category) > 30 else category
        prompt += f", –∫–∞—Ç: {cat_short}"
    
    prompt += f"\n\n–ü–æ—á–µ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç ¬´{product}¬ª? –û—Ç–≤–µ—Ç: 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è."
    
    return prompt




def explain_with_yandexgpt(
    profile: Dict,
    product: str,
    use_cache: bool = True
) -> str:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ YandexGPT Responses API.
    
    :param profile: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    :param product: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
    :param use_cache: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    :return: –¢–µ–∫—Å—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
    """
    # –°–æ–∑–¥–∞–µ–º –∫–ª—é—á –∫—ç—à–∞
    cache_key = hashlib.md5(
        json.dumps({**profile, "product": product}, sort_keys=True).encode()
    ).hexdigest()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
    if use_cache and cache_key in _explanation_cache:
        return _explanation_cache[cache_key]
    
    # –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Yandex Cloud
    try:
        from src.utils.yandex_gpt_client import call_yandex_gpt
        
        # –°—Ç—Ä–æ–∏–º –ø—Ä–æ–º–ø—Ç
        prompt = build_prompt(profile, product)
        
        # –í—ã–∑—ã–≤–∞–µ–º YandexGPT Responses API (—Å–∂–∞—Ç—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
        explanation = call_yandex_gpt(
            input_text=prompt,
            instructions="–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ü–°–ë. –û—Ç–≤–µ—Ç: 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –ø–æ-—Ä—É—Å—Å–∫–∏.",
            temperature=0.3
        )
        
        # –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        if use_cache:
            _explanation_cache[cache_key] = explanation
        
        return explanation
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ YandexGPT API: {e}")
        return _get_fallback_explanation(profile, product, use_cache, cache_key)


def _get_fallback_explanation(
    profile: Dict,
    product: str,
    use_cache: bool,
    cache_key: Optional[str]
) -> str:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç fallback –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è.
    
    :param profile: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    :param product: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
    :param use_cache: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à
    :param cache_key: –ö–ª—é—á –∫—ç—à–∞
    :return: –¢–µ–∫—Å—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
    """
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
    avg_tx = profile.get("avg_tx", 0)
    num_payments = profile.get("num_payments", 0)
    top_cat = profile.get("top_category") or profile.get("top_brand_category") or "–ø–æ–∫—É–ø–∫–∞–º"
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —á–∞—Å—Ç—å
    stats_part = ""
    if num_payments > 5:
        stats_part = f"–£—á–∏—Ç—ã–≤–∞—è –≤–∞—à–∏ {num_payments} —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π"
        if avg_tx > 1000:
            stats_part += f" —Å–æ —Å—Ä–µ–¥–Ω–∏–º —á–µ–∫–æ–º {avg_tx:.0f}‚ÇΩ"
    elif num_payments > 0:
        stats_part = "–ù–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–π –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"
    else:
        stats_part = "–î–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –≤–∞—à–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º"

    # –®–∞–±–ª–æ–Ω—ã –¥–ª—è fallback —Å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π
    fallback_templates = {
        "–°–µ–º–µ–π–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞": [
            f"{stats_part}, ¬´–°–µ–º–µ–π–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞¬ª –ø–æ–º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å –∂–∏–ª–∏—â–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Å –≥–æ—Å–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π (–∏–Ω—Ç–µ—Ä–µ—Å –∫ '{top_cat}').",
            f"–ú—ã –∑–∞–º–µ—Ç–∏–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å –∫ –∫—Ä—É–ø–Ω—ã–º –ø–æ–∫—É–ø–∫–∞–º ({top_cat}). –ò–ø–æ—Ç–µ–∫–∞ –æ—Ç –ü–°–ë ‚Äî —ç—Ç–æ –≤—ã–≥–æ–¥–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –¥–ª—è —Å–µ–º–µ–π.",
            "–í–∞—à–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è –≥–æ–≤–æ—Ä–∏—Ç –æ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏–ø–æ—Ç–µ–∫—É –¥–ª—è –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏.",
        ],
        "–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ¬´100+¬ª": [
            f"{stats_part}, –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ¬´100+¬ª —Å –¥–ª–∏–Ω–Ω—ã–º –ª—å–≥–æ—Ç–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º –±—É–¥–µ—Ç –≤—ã–≥–æ–¥–Ω–∞ –¥–ª—è –ø–æ–∫—É–ø–æ–∫ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ '{top_cat}'.",
            f"–í—ã —á–∞—Å—Ç–æ —Å–æ–≤–µ—Ä—à–∞–µ—Ç–µ –ø–ª–∞—Ç–µ–∂–∏. –ö–∞—Ä—Ç–∞ ¬´100+¬ª –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–∫—É–ø–∞—Ç—å —Å–µ–π—á–∞—Å, –∞ –ø–ª–∞—Ç–∏—Ç—å –ø–æ—Ç–æ–º –±–µ–∑ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤.",
            "–î–ª—è –≤–∞—à–µ–≥–æ —Å—Ç–∏–ª—è —Ç—Ä–∞—Ç –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–æ–º.",
        ],
        "–í–∫–ª–∞–¥ ¬´–°–∏–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞¬ª": [
            f"{stats_part}, –≤–∫–ª–∞–¥ ¬´–°–∏–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞¬ª –ø–æ–º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏ –ø–æ–ª—É—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥.",
            "–í–∞—à–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–≥–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã —Å –≤—ã—Å–æ–∫–æ–π —Å—Ç–∞–≤–∫–æ–π.",
            "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∫–ª–∞–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –ø–æ–¥—É—à–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–¥ –≤—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç.",
        ],
        "–í–∫–ª–∞–¥ ¬´–°—Ç–∞–≤–∫–∞ –Ω–∞ –±—É–¥—É—â–µ–µ¬ª": [
            f"{stats_part}, ¬´–°—Ç–∞–≤–∫–∞ –Ω–∞ –±—É–¥—É—â–µ–µ¬ª ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–±–µ—Ä–µ–∂–µ–Ω–∏–π.",
            "–ò–Ω–≤–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ —Å–≤–æ–µ –±—É–¥—É—â–µ–µ —Å –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —Å—Ç–∞–≤–∫–æ–π –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –±–∞–Ω–∫–∞.",
            "–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã–≥–æ–¥–æ–π –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ù–ü–§.",
        ],
        "–í–∫–ª–∞–¥ ¬´–î—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–π¬ª": [
            f"{stats_part}, –≤–∫–ª–∞–¥ ¬´–î—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–π¬ª –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–µ –º–µ—Ç–∞–ª–ª—ã –Ω–∞ –≤—ã–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.",
            "–î–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ —Å–≤–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –ø–æ–º–æ—â—å—é '–∑–æ–ª–æ—Ç–æ–≥–æ' –≤–∫–ª–∞–¥–∞ –æ—Ç –ü–°–ë.",
            "–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –º–µ—Ç–∞–ª–ª–æ–≤ –∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –≤–∫–ª–∞–¥–∞ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–¥—É–∫—Ç–µ.",
        ],
        "–í–∫–ª–∞–¥ ¬´–ú–æ–π –¥–æ—Ö–æ–¥¬ª": [
            f"{stats_part}, –≤–∫–ª–∞–¥ ¬´–ú–æ–π –¥–æ—Ö–æ–¥¬ª –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤—ã–≥–æ–¥–Ω—É—é —Å—Ç–∞–≤–∫—É –∏ –±–æ–Ω—É—Å—ã –¥–ª—è –∑–∞—Ä–ø–ª–∞—Ç–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.",
            "–ü–æ–ª—É—á–∞–π—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ —Å–≤–æ–∏ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ —Å—Ä–æ–∫–∞.",
            "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –¥–ª—è –ø—Ä–∏—É–º–Ω–æ–∂–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–∞.",
        ],
        "–í–∫–ª–∞–¥ ¬´–°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥¬ª": [
            f"{stats_part}, ¬´–°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥¬ª –æ–±–µ—Å–ø–µ—á–∏—Ç –≤–∞–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤.",
            "–ü–æ–ª—É—á–∞–π—Ç–µ –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –¥–æ—Ö–æ–¥ –æ—Ç —Å–≤–æ–∏—Ö —Å–±–µ—Ä–µ–∂–µ–Ω–∏–π. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ü–µ–Ω–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å.",
            "–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü –¥–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–º –¥–Ω–µ.",
        ],
        "–í–∫–ª–∞–¥ ¬´–ú–æ—è –∫–æ–ø–∏–ª–∫–∞¬ª": [
            f"{stats_part}, ¬´–ú–æ—è –∫–æ–ø–∏–ª–∫–∞¬ª –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ–ø–æ–ª–Ω—è—Ç—å –≤–∫–ª–∞–¥ –∏ –∫–æ–ø–∏—Ç—å –±—ã—Å—Ç—Ä–µ–µ.",
            "–û—Ç–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–µ —Å—É–º–º—ã –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã. –£–¥–æ–±–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π.",
            "–ù–∞–∫–æ–ø–∏—Ç–µ –Ω–∞ –º–µ—á—Ç—É —Å –ø–æ–ø–æ–ª–Ω—è–µ–º—ã–º –≤–∫–ª–∞–¥–æ–º –æ—Ç –ü–°–ë.",
        ],
        "–í–∫–ª–∞–¥ ¬´–ú–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏¬ª": [
            f"{stats_part}, ¬´–ú–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏¬ª ‚Äî —ç—Ç–æ —Å–≤–æ–±–æ–¥–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤.",
            "–ü–æ–ø–æ–ª–Ω—è–π—Ç–µ –∏ —Å–Ω–∏–º–∞–π—Ç–µ –¥–µ–Ω—å–≥–∏, –∫–æ–≥–¥–∞ —É–¥–æ–±–Ω–æ. –ì–∏–±–∫–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –≤–∞—à–µ–≥–æ –∫–æ–º—Ñ–æ—Ä—Ç–∞.",
            "–í–∞—à–∏ –¥–µ–Ω—å–≥–∏ –≤—Å–µ–≥–¥–∞ –ø–æ–¥ —Ä—É–∫–æ–π —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞.",
        ],
        "–í–∫–ª–∞–¥ ¬´–í —é–∞–Ω—è—Ö¬ª": [
            f"{stats_part}, –≤–∫–ª–∞–¥ –≤ —é–∞–Ω—è—Ö ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è.",
            "–•—Ä–∞–Ω–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤ –Ω–∞–¥–µ–∂–Ω–æ–π –≤–∞–ª—é—Ç–µ –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω—ã —Å –≤—ã–≥–æ–¥–Ω–æ–π —Å—Ç–∞–≤–∫–æ–π.",
            "–í–∞–ª—é—Ç–Ω—ã–π –≤–∫–ª–∞–¥ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∫–æ–ª–µ–±–∞–Ω–∏–π –∫—É—Ä—Å–∞.",
        ],
        "–í–∫–ª–∞–¥ ¬´–°–æ—Ü–∏–∞–ª—å–Ω—ã–π –≤–∫–ª–∞–¥¬ª": [
            f"{stats_part}, ¬´–°–æ—Ü–∏–∞–ª—å–Ω—ã–π –≤–∫–ª–∞–¥¬ª –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ—Ç –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–∞.",
            "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –Ω–∞ –ª—é–±—É—é —Å—É–º–º—É. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –≤—ã–≥–æ–¥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.",
            "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç —Å –∑–∞–±–æ—Ç–æ–π –æ –≤–∞—Å.",
        ],
        "–ò–ø–æ—Ç–µ–∫–∞ ¬´–í—Ç–æ—Ä–∏—á–Ω–æ–µ –∂–∏–ª—å–µ¬ª": [
            f"{stats_part}, –∏–ø–æ—Ç–µ–∫–∞ –Ω–∞ –≤—Ç–æ—Ä–∏—á–Ω–æ–µ –∂–∏–ª—å–µ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –∫–≤–∞—Ä—Ç–∏—Ä—É –º–µ—á—Ç—ã.",
            "–í—ã–≥–æ–¥–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –∏ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –≥–æ—Ç–æ–≤–æ–≥–æ –∂–∏–ª—å—è.",
            "–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –±–ª–∏–∂–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞—à–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –≤—Ç–æ—Ä–∏—á–Ω–æ–º—É –∂–∏–ª—å—é.",
        ],
        "–ò–ø–æ—Ç–µ–∫–∞ ¬´–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞¬ª": [
            f"{stats_part}, –∏–ø–æ—Ç–µ–∫–∞ –Ω–∞ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫—É ‚Äî —ç—Ç–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–µ –±—É–¥—É—â–µ–µ.",
            "–õ—å–≥–æ—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—Ç –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–æ–≤-–ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤.",
            "–ö—É–ø–∏—Ç–µ –∫–≤–∞—Ä—Ç–∏—Ä—É –≤ –Ω–æ–≤–æ–º –¥–æ–º–µ —Å –≤—ã–≥–æ–¥–æ–π –æ—Ç –ü–°–ë.",
        ],
        "–ì–æ—Å–ø—Ä–æ–≥—Ä–∞–º–º–∞ ¬´–ù–æ–≤—ã–µ —Å—É–±—ä–µ–∫—Ç—ã¬ª": [
            f"{stats_part}, –ª—å–≥–æ—Ç–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞ 2% –¥–ª—è –∂–∏—Ç–µ–ª–µ–π –Ω–æ–≤—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤.",
            "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –¥–ª—è –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—è –∂–∏–ª—å—è –≤ –Ω–æ–≤—ã—Ö —Å—É–±—ä–µ–∫—Ç–∞—Ö –†–§.",
            "–î–æ—Å—Ç—É–ø–Ω–æ–µ –∂–∏–ª—å–µ —Å –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.",
        ],
        "–°–µ–º–µ–π–Ω–∞—è –≤–æ–µ–Ω–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞": [
            f"{stats_part}, —Å–µ–º–µ–π–Ω–∞—è –≤–æ–µ–Ω–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–≤—É—Ö –ø—Ä–æ–≥—Ä–∞–º–º.",
            "–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –¥–ª—è —Å–µ–º–µ–π –≤–æ–µ–Ω–Ω–æ—Å–ª—É–∂–∞—â–∏—Ö. –ó–∞–±–æ—Ç–∞ –æ —Ç–µ—Ö, –∫—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –†–æ–¥–∏–Ω—É.",
            "–í—ã–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—è –∂–∏–ª—å—è —Å–µ–º—å—è–º –≤–æ–µ–Ω–Ω—ã—Ö.",
        ],
        "–í–æ–µ–Ω–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞": [
            f"{stats_part}, –≤–æ–µ–Ω–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞ ‚Äî —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –∂–∏–ª—å–µ –∑–∞ —Å—á–µ—Ç –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–∞.",
            "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ-–∏–ø–æ—Ç–µ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫—É–ø–∏—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—É —É–∂–µ —Å–µ–π—á–∞—Å.",
            "–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –≤–æ–µ–Ω–Ω–æ—Å–ª—É–∂–∞—â–∏—Ö —Å –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.",
        ],
        "–í–æ–µ–Ω–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞ ¬´–ù–æ–≤—ã–µ —Å—É–±—ä–µ–∫—Ç—ã¬ª": [
            f"{stats_part}, –≤–æ–µ–Ω–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞ –ø–æ–¥ 2% –≤ –Ω–æ–≤—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö.",
            "–û—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –≤–æ–µ–Ω–Ω–æ—Å–ª—É–∂–∞—â–∏—Ö –≤ –Ω–æ–≤—ã—Ö —Å—É–±—ä–µ–∫—Ç–∞—Ö –†–§.",
            "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∂–∏–ª—å–µ –¥–ª—è –∑–∞—â–∏—Ç–Ω–∏–∫–æ–≤ –û—Ç–µ—á–µ—Å—Ç–≤–∞.",
        ],
        "–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–∞—è –∏ –∞—Ä–∫—Ç–∏—á–µ—Å–∫–∞—è –∏–ø–æ—Ç–µ–∫–∞": [
            f"{stats_part}, –∏–ø–æ—Ç–µ–∫–∞ 2% –¥–ª—è –∂–∏—Ç–µ–ª–µ–π –î–∞–ª—å–Ω–µ–≥–æ –í–æ—Å—Ç–æ–∫–∞ –∏ –ê—Ä–∫—Ç–∏–∫–∏.",
            "–õ—å–≥–æ—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∂–∏–ª—å—è –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö —Ä–∞–∑–≤–∏—Ç–∏—è.",
            "–ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Å–≤–æ–π –¥–æ–º –∏–ª–∏ –∫—É–ø–∏—Ç–µ –∫–≤–∞—Ä—Ç–∏—Ä—É –Ω–∞ –≤—ã–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.",
        ],
        "–ö—Ä–µ–¥–∏—Ç –ø–æ–¥ –∑–∞–ª–æ–≥ –∫–≤–∞—Ä—Ç–∏—Ä—ã": [
            f"{stats_part}, –∫—Ä–µ–¥–∏—Ç –ø–æ–¥ –∑–∞–ª–æ–≥ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –ø–æ–º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –∫—Ä—É–ø–Ω—É—é —Å—É–º–º—É –Ω–∞ –ª—é–±—ã–µ —Ü–µ–ª–∏.",
            "–í—ã–≥–æ–¥–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–æ–º—É –∫—Ä–µ–¥–∏—Ç—É —Å –Ω–∏–∑–∫–æ–π —Å—Ç–∞–≤–∫–æ–π.",
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–∫—Ç–∏–≤ –≤ –≤–∏–¥–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∑–∞–¥–∞—á.",
        ],
        "–†–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ø–æ—Ç–µ–∫–∏": [
            f"{stats_part}, —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ø–æ—Ç–µ–∫–∏ –ø–æ–º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å –ø–ª–∞—Ç–µ–∂ –∏–ª–∏ —Å—Ç–∞–≤–∫—É.",
            "–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –∏–ø–æ—Ç–µ–∫—É –≤ –ü–°–ë –∏ –ø–ª–∞—Ç–∏—Ç–µ –º–µ–Ω—å—à–µ.",
            "–£–ª—É—á—à–∏—Ç–µ —É—Å–ª–æ–≤–∏—è –ø–æ –¥–µ–π—Å—Ç–≤—É—é—â–µ–π –∏–ø–æ—Ç–µ–∫–µ —Å –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è.",
        ],
        "–í–æ–µ–Ω–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞ (–†–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ)": [
            f"{stats_part}, —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–µ–Ω–Ω–æ–π –∏–ø–æ—Ç–µ–∫–∏ –Ω–∞ –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.",
            "–°–Ω–∏–∑—å—Ç–µ —Å—Ç–∞–≤–∫—É –ø–æ –¥–µ–π—Å—Ç–≤—É—é—â–µ–π –≤–æ–µ–Ω–Ω–æ–π –∏–ø–æ—Ç–µ–∫–µ.",
            "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã–ø–ª–∞—Ç –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ù–ò–°.",
        ],
        "–ö—Ä–µ–¥–∏—Ç –Ω–∞ –ª—é–±—ã–µ —Ü–µ–ª–∏": [
            f"{stats_part}, –∫—Ä–µ–¥–∏—Ç –Ω–∞ –ª—é–±—ã–µ —Ü–µ–ª–∏ –ø–æ–º–æ–∂–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞—à–∏ –ø–ª–∞–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ '{top_cat}').",
            "–ï—Å–ª–∏ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∫—Ä—É–ø–Ω—ã–µ —Ç—Ä–∞—Ç—ã, –Ω–∞—à –∫—Ä–µ–¥–∏—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π –ø–ª–∞—Ç–µ–∂ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è.",
            "–ö—Ä–µ–¥–∏—Ç –Ω–∞–ª–∏—á–Ω—ã–º–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –≤–∞—à–∏—Ö —Ç–µ–∫—É—â–∏—Ö –∑–∞–¥–∞—á. –°—Ç–∞–≤–∫–∞ –æ—Ç 4.5%.",
        ],
        "–†–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤": [
            f"{stats_part}, —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–∂–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤–∞—à–∏ –∫—Ä–µ–¥–∏—Ç—ã –≤ –æ–¥–∏–Ω —Å –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ–π —Å—Ç–∞–≤–∫–æ–π.",
            "–ü–ª–∞—Ç–∏—Ç–µ –º–µ–Ω—å—à–µ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü, –æ–±—ä–µ–¥–∏–Ω–∏–≤ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏. –£–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –æ–¥–∏–Ω –ø–ª–∞—Ç–µ–∂.",
            "–°–Ω–∏–∑—å—Ç–µ –∫—Ä–µ–¥–∏—Ç–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç –ü–°–ë.",
        ],
        "–≠–∫—Å–ø—Ä–µ—Å—Å-–∫—Ä–µ–¥–∏—Ç ¬´–¢—É—Ä–±–æ–¥–µ–Ω—å–≥–∏¬ª": [
            f"{stats_part}, ¬´–¢—É—Ä–±–æ–¥–µ–Ω—å–≥–∏¬ª ‚Äî —ç—Ç–æ –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∫—Ä–µ–¥–∏—Ç –Ω–∞ –∫–∞—Ä—Ç—É –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫.",
            "–î–µ–Ω—å–≥–∏ –∑–∞ 5 –º–∏–Ω—É—Ç –±–µ–∑ –≤–∏–∑–∏—Ç–∞ –≤ –±–∞–Ω–∫. –ü—Ä–æ—Å—Ç–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.",
            "–ö–æ–≥–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω—É–∂–Ω—ã —Å—Ä–æ—á–Ω–æ, ¬´–¢—É—Ä–±–æ–¥–µ–Ω—å–≥–∏¬ª –≤—Å–µ–≥–¥–∞ –ø–æ–¥ —Ä—É–∫–æ–π.",
        ],
        "–ö—Ä–µ–¥–∏—Ç –¥–ª—è —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –û–ü–ö –∏ –≤–æ–µ–Ω–Ω–æ—Å–ª—É–∂–∞—â–∏—Ö": [
            f"{stats_part}, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫—Ä–µ–¥–∏—Ç –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –û–ü–ö –∏ –≤–æ–µ–Ω–Ω–æ—Å–ª—É–∂–∞—â–∏—Ö —Å –ª—å–≥–æ—Ç–Ω–æ–π —Å—Ç–∞–≤–∫–æ–π.",
            "–û—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ–±–æ—Ä–æ–Ω—É —Å—Ç—Ä–∞–Ω—ã. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.",
            "–ù–∏–∑–∫–∞—è —Å—Ç–∞–≤–∫–∞ –∏ –ª–æ—è–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –æ–±–æ—Ä–æ–Ω–Ω–æ-–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞.",
        ],
        "–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ¬´–¢–≤–æ–π –∫—ç—à–±—ç–∫¬ª": [
            f"{stats_part}, –¥–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ¬´–¢–≤–æ–π –∫—ç—à–±—ç–∫¬ª —Å–¥–µ–ª–∞–µ—Ç –≤–∞—à–∏ –ø–æ–∫—É–ø–∫–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ '{top_cat}' –≤—ã–≥–æ–¥–Ω–µ–µ.",
            "–≠—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö —Ç—Ä–∞—Ç —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∫—ç—à–±—ç–∫–∞.",
            "–ü–æ–ª—É—á–∞–π—Ç–µ –∫—ç—à–±—ç–∫ —Ä—É–±–ª—è–º–∏ –∑–∞ –≤–∞—à–∏ –ø—Ä–∏–≤—ã—á–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ —Å –∫–∞—Ä—Ç–æ–π –ü–°–ë.",
        ],
        "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á–µ—Ç ¬´–ê–∫—Ü–µ–Ω—Ç¬ª": [
            f"{stats_part}, –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á–µ—Ç ¬´–ê–∫—Ü–µ–Ω—Ç¬ª —Å–æ—á–µ—Ç–∞–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –≤–∫–ª–∞–¥–∞ –∏ –≥–∏–±–∫–æ—Å—Ç—å —Å—á–µ—Ç–∞.",
            "–î–µ—Ä–∂–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ–¥ —Ä—É–∫–æ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç –Ω–∞ –æ—Å—Ç–∞—Ç–æ–∫. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.",
            "–í—ã —á–∞—Å—Ç–æ —Å–æ–≤–µ—Ä—à–∞–µ—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á–µ—Ç ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤.",
        ],
        "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á–µ—Ç ¬´–ü—Ä–æ –∑–∞–ø–∞—Å¬ª": [
            f"{stats_part}, —Å—á–µ—Ç ¬´–ü—Ä–æ –∑–∞–ø–∞—Å¬ª –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—é –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫.",
            "–í—ã–≥–æ–¥–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –ø–µ—Ä–≤—ã–µ 2 –º–µ—Å—è—Ü–∞. –ù–∞—á–Ω–∏—Ç–µ –∫–æ–ø–∏—Ç—å —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã–≥–æ–¥–æ–π.",
            "–ù–∞–∫–∞–ø–ª–∏–≤–∞–π—Ç–µ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ —Å–Ω—è—Ç–∏–µ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –ª–∏—à–Ω–∏—Ö —Ç—Ä–∞—Ç.",
        ],
        "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á–µ—Ç ¬´–•—Ä–∞–Ω–∏—Ç–µ–ª—å¬ª": [
            f"{stats_part}, —Å—á–µ—Ç ¬´–•—Ä–∞–Ω–∏—Ç–µ–ª—å¬ª –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≥–∏–±–∫–∏–µ —É—Å–ª–æ–≤–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤.",
            "–í—ã–±–∏—Ä–∞–π—Ç–µ —Å–≤–æ–∏ –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è: –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–ª–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫.",
            "–°–≤–æ–±–æ–¥–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.",
        ],
        "–ü–∞–∫–µ—Ç ¬´Orange Premium Club¬ª": [
            f"{stats_part}, –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç ¬´Orange Premium Club¬ª –æ—Ç–∫—Ä–æ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –±–∏–∑–Ω–µ—Å-–∑–∞–ª–∞–º –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é.",
            "–í–∞—à —Å—Ç–∞—Ç—É—Å –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –æ—Å–æ–±—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π: –∫–æ–Ω—Å—å–µ—Ä–∂-—Å–µ—Ä–≤–∏—Å, —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –∏ –ø–æ–≤—ã—à–µ–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏.",
            "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–º—Ñ–æ—Ä—Ç –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –≤—ã–≥–æ–¥–∞ —Å –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ–º –æ—Ç –ü–°–ë.",
        ],
        "–ö–ª—É–±–Ω–∞—è –∫–∞—Ä—Ç–∞ –ü–§–ö –¶–°–ö–ê": [
            f"{stats_part}, –∫–ª—É–±–Ω–∞—è –∫–∞—Ä—Ç–∞ –ü–§–ö –¶–°–ö–ê ‚Äî —ç—Ç–æ –±–æ–ª—å—à–µ —á–µ–º –ø—Ä–æ—Å—Ç–æ –∫–∞—Ä—Ç–∞. –≠—Ç–æ –ø—Ä–æ–ø—É—Å–∫ –≤ –º–∏—Ä —Ñ—É—Ç–±–æ–ª–∞.",
            f"–í—ã –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç–µ—Å—å —Å–ø–æ—Ä—Ç–æ–º ({top_cat}). –ü–æ–ª—É—á–∞–π—Ç–µ –∫—ç—à–±—ç–∫ –∑–∞ –±–∏–ª–µ—Ç—ã, –∞—Ç—Ä–∏–±—É—Ç–∏–∫—É –∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã.",
            "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –¥–ª—è –±–æ–ª–µ–ª—å—â–∏–∫–æ–≤. –ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ –ª—é–±–∏–º—É—é –∫–æ–º–∞–Ω–¥—É!",
        ],
        "–ö–∞—Ä—Ç–∞ ¬´–°–í–û–∏¬ª": [
            f"{stats_part}, –∫–∞—Ä—Ç–∞ ¬´–°–í–û–∏¬ª ‚Äî —ç—Ç–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –≤–µ—Ç–µ—Ä–∞–Ω–∞ –±–æ–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.",
            "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è, –ª—å–≥–æ—Ç—ã –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã –Ω–∞ –æ–¥–Ω—É —É–¥–æ–±–Ω—É—é –∫–∞—Ä—Ç—É.",
            "–ë—ã—Å—Ç—Ä–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –¥–æ—Å—Ç—É–ø –∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º —É—Å–ª—É–≥–∞–º.",
        ],
        "–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ¬´–¢–æ–ª—å–∫–æ –≤–ø–µ—Ä–µ–¥¬ª": [
            f"{stats_part}, –∫–∞—Ä—Ç–∞ ¬´–¢–æ–ª—å–∫–æ –≤–ø–µ—Ä–µ–¥¬ª –≤—ã–≥–æ–¥–Ω–∞ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Å–ª–µ–¥–∏—Ç –∑–∞ –∑–¥–æ—Ä–æ–≤—å–µ–º (–∫—ç—à–±—ç–∫ –≤ –∞–ø—Ç–µ–∫–∞—Ö –∏ —Å–ø–æ—Ä—Ç—Ç–æ–≤–∞—Ä–∞—Ö).",
            "–ü–æ–ª—É—á–∞–π—Ç–µ –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π –∫—ç—à–±—ç–∫ –∑–∞ —Å–ø–æ—Ä—Ç –∏ –º–µ–¥–∏—Ü–∏–Ω—É. –ò–Ω–≤–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ —Å–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ —Å –≤—ã–≥–æ–¥–æ–π.",
            "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ó–û–ñ.",
        ],
        "–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ¬´180 –¥–Ω–µ–π –±–µ–∑ %¬ª": [
            f"{stats_part}, –∫–∞—Ä—Ç–∞ ¬´180 –¥–Ω–µ–π –±–µ–∑ %¬ª –ø–æ–∑–≤–æ–ª–∏—Ç —Å–æ–≤–µ—Ä—à–∞—Ç—å –∫—Ä—É–ø–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–ø–ª–∞—Ç—ã –ø–æ–ª–≥–æ–¥–∞.",
            "–î–ª–∏–Ω–Ω—ã–π –ª—å–≥–æ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–µ–º–æ–Ω—Ç–∞, –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –∏ –±–æ–ª—å—à–∏—Ö –ø–ª–∞–Ω–æ–≤.",
            "–ó–∞–±—É–¥—å—Ç–µ –æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –Ω–∞ 180 –¥–Ω–µ–π. –ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –Ω–∞–≤—Å–µ–≥–¥–∞.",
        ],
        "–î–µ–±–µ—Ç–æ–≤–∞—è –ø–µ–Ω—Å–∏–æ–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞ –ü–°–ë": [
            f"{stats_part}, –ø–µ–Ω—Å–∏–æ–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞ –ü–°–ë ‚Äî —ç—Ç–æ —É–¥–æ–±–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–µ–Ω—Å–∏–∏ –∏ –¥–æ—Ö–æ–¥ –Ω–∞ –æ—Å—Ç–∞—Ç–æ–∫.",
            "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ —Å–Ω—è—Ç–∏–µ –Ω–∞–ª–∏—á–Ω—ã—Ö, –∫–µ—à–±—ç–∫ –≤ –∞–ø—Ç–µ–∫–∞—Ö –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø–µ–Ω—Å–∏–æ–Ω–µ—Ä–æ–≤.",
            "–ó–∞–±–æ—Ç–∞ –æ –≤–∞—à–∏—Ö —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è—Ö —Å –Ω–∞–¥–µ–∂–Ω—ã–º –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º –±–∞–Ω–∫–æ–º.",
        ],
        "–ó–∞—Ä–ø–ª–∞—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ¬´–¢–≤–æ–π –ü–ª—é—Å¬ª": [
            f"{stats_part}, –∫–∞—Ä—Ç–∞ ¬´–¢–≤–æ–π –ü–ª—é—Å¬ª —Å–¥–µ–ª–∞–µ—Ç –≤–∞—à—É –∑–∞—Ä–ø–ª–∞—Ç—É –µ—â–µ –≤—ã–≥–æ–¥–Ω–µ–µ.",
            "–ü–æ–≤—ã—à–µ–Ω–Ω—ã–π –∫—ç—à–±—ç–∫, –¥–æ—Ö–æ–¥ –Ω–∞ –æ—Å—Ç–∞—Ç–æ–∫ –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã.",
            "–ü–æ–ª—É—á–∞–π—Ç–µ –º–∞–∫—Å–∏–º—É–º –æ—Ç —Å–≤–æ–∏—Ö –¥–æ—Ö–æ–¥–æ–≤ —Å –∑–∞—Ä–ø–ª–∞—Ç–Ω–æ–π –∫–∞—Ä—Ç–æ–π –ü–°–ë.",
        ],
        "–ó–∞—Ä–ø–ª–∞—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ¬´–ó–∞—Ä–ø–ª–∞—Ç–∞ PRO¬ª": [
            f"{stats_part}, ¬´–ó–∞—Ä–ø–ª–∞—Ç–∞ PRO¬ª ‚Äî —ç—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ñ–∏–Ω–∞–Ω—Å–∞–º.",
            "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–≤–æ–¥—ã –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º.",
            "–ò–¥–µ–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã –∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö —Ç—Ä–∞—Ç.",
        ],
        "–ó–∞—Ä–ø–ª–∞—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ¬´–°–∏–ª—å–Ω—ã–µ –ª—é–¥–∏¬ª": [
            f"{stats_part}, –∫–∞—Ä—Ç–∞ ¬´–°–∏–ª—å–Ω—ã–µ –ª—é–¥–∏¬ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å–∏–ª–æ–≤—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä.",
            "–û—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è, –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π –∫—ç—à–±—ç–∫ –∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ —Å–Ω—è—Ç–∏–µ –Ω–∞–ª–∏—á–Ω—ã—Ö –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏.",
            "–ù–∞–¥–µ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Å–ª—É–∂–∏—Ç –†–æ–¥–∏–Ω–µ.",
        ],
        "–ö–∞—Ä—Ç–∞ –∂–∏—Ç–µ–ª—è": [
            f"{stats_part}, ¬´–ö–∞—Ä—Ç–∞ –∂–∏—Ç–µ–ª—è¬ª –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –≤–∞—à–µ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞.",
            "–û–ø–ª–∞—Ç–∞ –ø—Ä–æ–µ–∑–¥–∞, –ø–æ–ª—É—á–µ–Ω–∏–µ –ª—å–≥–æ—Ç –∏ –≤—ã–≥–æ–¥–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –≤ –æ–¥–Ω–æ–π –∫–∞—Ä—Ç–µ.",
            "–£–¥–æ–±–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∂–∏–∑–Ω–∏ –≤ –≤–∞—à–µ–º –≥–æ—Ä–æ–¥–µ.",
        ],
        "–ü–°–ë –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏": [
            f"{stats_part}, ¬´–ü–°–ë –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏¬ª ‚Äî —ç—Ç–æ –≤–∞—à –ø—É—Ç—å –∫ –ø—Ä–∏—É–º–Ω–æ–∂–µ–Ω–∏—é –∫–∞–ø–∏—Ç–∞–ª–∞ –Ω–∞ —Ñ–æ–Ω–¥–æ–≤–æ–º —Ä—ã–Ω–∫–µ.",
            "–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–æ–∫–µ—Ä—Å–∫–∏–π —Å—á–µ—Ç, –ò–ò–° –∏–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –≥–æ—Ç–æ–≤—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏.",
            "–ù–∞—á–Ω–∏—Ç–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–∞–¥–µ–∂–Ω—ã–º –±–∞–Ω–∫–æ–º –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –¥–æ—Ö–æ–¥.",
        ],
        "–ú—É–ª—å—Ç–∏–Æ—Ä–∏—Å—Ç": [
            f"{stats_part}, ¬´–ú—É–ª—å—Ç–∏–Æ—Ä–∏—Å—Ç¬ª ‚Äî –≤–∞—à–∞ –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–∞—è –ø—Ä–∞–≤–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞.",
            "–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏ –ø–æ–º–æ—â—å —Å –Ω–∞–ª–æ–≥–æ–≤—ã–º –≤—ã—á–µ—Ç–æ–º –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è.",
            "–ù–∞–¥–µ–∂–Ω–∞—è –∑–∞—â–∏—Ç–∞ –≤–∞—à–∏—Ö –ø—Ä–∞–≤ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ —Å–µ–º—å–∏.",
        ],
        "–ó–∞—â–∏—Ç–∞ –≤–∫–ª–∞–¥–∞": [
            f"{stats_part}, –∑–∞—â–∏—Ç–∏—Ç–µ —Å–≤–æ–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π ¬´–ó–∞—â–∏—Ç–∞ –≤–∫–ª–∞–¥–∞¬ª.",
            "–í–æ–∑–º–µ—â–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Å—Ç—Ä–∞—Ö–æ–≤–æ–º —Å–ª—É—á–∞–µ. –°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –∑–∞ –≤–∞—à–∏ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è.",
            "–ì–∞—Ä–∞–Ω—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏ –≤–∞—à–∏—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏ –¥–æ—Ö–æ–¥–∞.",
        ],
        "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞": [
            f"{stats_part}, ¬´–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞¬ª –æ–±–µ–∑–æ–ø–∞—Å–∏—Ç –≤–∞—à–∏ –∫–∞—Ä—Ç—ã –æ—Ç –º–æ—à–µ–Ω–Ω–∏–∫–æ–≤.",
            "–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –≤—Å–µ—Ö –∫–∞—Ä—Ç–∞—Ö –ü–°–ë. –í–æ–∑–º–µ—â–µ–Ω–∏–µ –ø—Ä–∏ —Ö–∏—â–µ–Ω–∏–∏ –∏–ª–∏ —É—Ç–µ—Ä–µ.",
            "–ß—É–≤—Å—Ç–≤—É–π—Ç–µ —Å–µ–±—è —É–≤–µ—Ä–µ–Ω–Ω–æ –ø—Ä–∏ –ª—é–±—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å –∫–∞—Ä—Ç–æ–π.",
        ],
        "–î–æ–º–∞—à–Ω–∏–π –∫—ç—à–±—ç–∫": [
            f"{stats_part}, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç ¬´–î–æ–º–∞—à–Ω–∏–π –∫—ç—à–±—ç–∫¬ª ‚Äî —ç—Ç–æ –≤—ã–≥–æ–¥–∞ –∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞.",
            "–¶–µ–Ω–Ω–æ—Å—Ç—å —É—Å–ª—É–≥ –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞. –ù–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä –ü—Ä–∞–≤–æ–∫–∞—Ä–¥.",
            "–£–¥–æ–±–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤.",
        ],
        "–ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π": [
            f"{stats_part}, –ø—Ä–æ–≥—Ä–∞–º–º–∞ ¬´–ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π¬ª ‚Äî —ç—Ç–æ –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Å—á–∞—Å—Ç–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤.",
            "–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ —Ç—Ä–∞–≤–º–∞—Ö. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞ 5 –º–∏–Ω—É—Ç.",
            "–ó–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ –∏ –±–ª–∏–∑–∫–∏—Ö —Å –≤—ã–ø–ª–∞—Ç–∞–º–∏ –¥–æ 2,9 –º–ª–Ω ‚ÇΩ.",
        ],
        "–ê–≤—Ç–æ–ø–æ–º–æ—â—å –Ω–∞ –¥–æ—Ä–æ–≥–∞—Ö": [
            f"{stats_part}, ¬´–ê–≤—Ç–æ–ø–æ–º–æ—â—å –Ω–∞ –¥–æ—Ä–æ–≥–∞—Ö¬ª ‚Äî –Ω–∞–¥–µ–∂–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∞–≤—Ç–æ–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤.",
            "–¢–µ—Ö–ø–æ–º–æ—â—å, —ç–≤–∞–∫—É–∞—Ü–∏—è –∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ 24/7 –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏.",
            "–ë—É–¥—å—Ç–µ —É–≤–µ—Ä–µ–Ω—ã –≤ –∫–∞–∂–¥–æ–π –ø–æ–µ–∑–¥–∫–µ —Å –ü–°–ë.",
        ],
        "–ë—É–¥—å—Ç–µ –∑–¥–æ—Ä–æ–≤—ã": [
            f"{stats_part}, –ø—Ä–æ–≥—Ä–∞–º–º–∞ ¬´–ë—É–¥—å—Ç–µ –∑–¥–æ—Ä–æ–≤—ã¬ª ‚Äî —ç—Ç–æ –¥–æ—Å—Ç—É–ø –∫ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –º–µ–¥–∏—Ü–∏–Ω–µ.",
            "–¢–µ–ª–µ–º–µ–¥–∏—Ü–∏–Ω–∞ 24/7 –∏ —á–µ–∫–∞–ø—ã –≤ –≤–µ–¥—É—â–∏—Ö –∫–ª–∏–Ω–∏–∫–∞—Ö –¥–ª—è –≤—Å–µ–π —Å–µ–º—å–∏.",
            "–ó–∞–±–æ—Ç–∞ –æ –∑–¥–æ—Ä–æ–≤—å–µ –±–µ–∑ –æ—á–µ—Ä–µ–¥–µ–π –∏ –ª–∏—à–Ω–∏—Ö –∑–∞—Ç—Ä–∞—Ç.",
        ],
        "–ú–æ—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è": [
            f"{stats_part}, –∑–∞—â–∏—Ç–∏—Ç–µ —Å–≤–æ–π –¥–æ–º —Å –ø—Ä–æ–≥—Ä–∞–º–º–æ–π ¬´–ú–æ—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è¬ª.",
            "–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∏–º—É—â–µ—Å—Ç–≤–∞ –±–µ–∑ –æ—Å–º–æ—Ç—Ä–∞. –ë—ã—Å—Ç—Ä–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω.",
            "–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –∑–∞ –≤–∞—à—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –∏ —Ä–µ–º–æ–Ω—Ç.",
        ],
        "–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤": [
            f"{stats_part}, —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ –¥–ª—è –±–µ–∑–∑–∞–±–æ—Ç–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞.",
            "–ü–æ–∫—Ä—ã—Ç–∏–µ –¥–æ 50 000 $ –∏ –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞ –≥—Ä–∞–Ω–∏—Ü–µ–π.",
            "–ù–∞–¥–µ–∂–Ω–∞—è –∑–∞—â–∏—Ç–∞ –≤ –ª—é–±–æ–π —Ç–æ—á–∫–µ –º–∏—Ä–∞.",
        ],
        "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏": [
            f"{stats_part}, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—è —á–∏—Å—Ç–æ—Ç—ã —Å–¥–µ–ª–∫–∏.",
            "–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –æ–±—ä–µ–∫—Ç–∞ –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç —Ä–∏—Å–∫–æ–≤ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ.",
            "–ü–æ–∫—É–ø–∞–π—Ç–µ –∂–∏–ª—å–µ —É–≤–µ—Ä–µ–Ω–Ω–æ —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π.",
        ],
        "–û–°–ê–ì–û": [
            f"{stats_part}, –æ—Ñ–æ—Ä–º–∏—Ç–µ –û–°–ê–ì–û –æ–Ω–ª–∞–π–Ω –∑–∞ 3 –º–∏–Ω—É—Ç—ã.",
            "–í—ã–±–æ—Ä –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –æ—Ç –≤–µ–¥—É—â–∏—Ö —Å—Ç—Ä–∞—Ö–æ–≤—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π. –ù–∞–¥–µ–∂–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ.",
            "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –≤–∏–∑–∏—Ç–∞ –≤ –æ—Ñ–∏—Å.",
        ],
        "–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –æ—Ç –ø–æ—Ç–µ—Ä–∏ —Ä–∞–±–æ—Ç—ã": [
            f"{stats_part}, —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –æ—Ç –ø–æ—Ç–µ—Ä–∏ —Ä–∞–±–æ—Ç—ã ‚Äî –≤–∞—à–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–¥—É—à–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.",
            "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ 5 –º–µ—Å—è—Ü–µ–≤ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –¥–æ—Ö–æ–¥–∞. –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–º –¥–Ω–µ.",
            "–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–∏–≤—ã—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∂–∏–∑–Ω–∏ –≤ —Å–ª–æ–∂–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.",
        ],
        "–ü—Ä–∏–µ–º–∫–∞ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∂–∏–ª—å—è": [
            f"{stats_part}, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–∏–µ–º–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã –≤ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–µ.",
            "–≠–∫—Å–ø–µ—Ä—Ç—ã –≤—ã—è–≤—è—Ç –≤—Å–µ –Ω–µ–¥–æ—á–µ—Ç—ã –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞. –≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ –±—É–¥—É—â–µ–º —Ä–µ–º–æ–Ω—Ç–µ.",
            "–ü—Ä–∏–º–∏—Ç–µ –∫–≤–∞—Ä—Ç–∏—Ä—É –±–µ–∑ —Å–∫—Ä—ã—Ç—ã—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤.",
        ],
        "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–∏": [
            f"{stats_part}, –ù–°–ñ ‚Äî —ç—Ç–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è, —Å—Ç—Ä–∞—Ö–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –∏ –Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç.",
            "–§–æ—Ä–º–∏—Ä—É–π—Ç–µ –∫–∞–ø–∏—Ç–∞–ª –∏ –∑–∞—â–∏—â–∞–π—Ç–µ —Å–µ–º—å—é –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏.",
            "–ò–Ω–≤–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ –±—É–¥—É—â–µ–µ —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤.",
        ],
        "–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∑–∞–µ–º—â–∏–∫–æ–≤ –∫—Ä–µ–¥–∏—Ç–æ–≤": [
            f"{stats_part}, —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∑–∞–µ–º—â–∏–∫–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–Ω–∏–∑–∏—Ç—å —Å—Ç–∞–≤–∫—É –ø–æ –∫—Ä–µ–¥–∏—Ç—É.",
            "–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –ø—Ä–∏ –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞—Ö. –í—ã–≥–æ–¥–Ω–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ.",
            "–ì–∞—Ä–∞–Ω—Ç–∏—è –ø–æ–≥–∞—à–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ç—Ä—É–¥–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.",
        ],
        "–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∏–ø–æ—Ç–µ—á–Ω—ã—Ö –∑–∞–µ–º—â–∏–∫–æ–≤": [
            f"{stats_part}, –∏–ø–æ—Ç–µ—á–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ –∏ –∑–∞—â–∏—Ç–∞ –≤–∞—à–µ–≥–æ –∂–∏–ª—å—è.",
            "–°–Ω–∏–∂–µ–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –ø–æ –∏–ø–æ—Ç–µ–∫–µ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –ø–æ–≥–∞—à–µ–Ω–∏–∏ –¥–æ–ª–≥–∞.",
            "–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –∂–∏–∑–Ω–∏ –∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –¥–ª—è –∏–ø–æ—Ç–µ—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.",
        ]
    }
    
    # –í—ã–±–∏—Ä–∞–µ–º —à–∞–±–ª–æ–Ω
    templates = fallback_templates.get(product, [
        f"{stats_part}, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ {product}."
    ])
    
    import random
    explanation = random.choice(templates)
    
    # –ö—ç—à–∏—Ä—É–µ–º fallback
    if use_cache and cache_key:
        _explanation_cache[cache_key] = explanation
    
    return explanation


def _normalize_product_name(product: str) -> str:
    """–ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞, –∑–∞–º–µ–Ω—è—è –æ–±—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –ü–°–ë."""
    generic_to_specific = {
        "–ö—Ä–µ–¥–∏—Ç": "–ö—Ä–µ–¥–∏—Ç –Ω–∞ –ª—é–±—ã–µ —Ü–µ–ª–∏",
        "–ò–ø–æ—Ç–µ–∫–∞": "–°–µ–º–µ–π–Ω–∞—è –∏–ø–æ—Ç–µ–∫–∞",
        "–ö—Ä–µ–¥–∏—Ç–∫–∞": "–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ¬´100+¬ª",
        "–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞": "–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ ¬´100+¬ª",
        "–í–∫–ª–∞–¥": "–í–∫–ª–∞–¥ ¬´–°–∏–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞¬ª",
        "–î–µ–±–µ—Ç": "–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ¬´–¢–≤–æ–π –∫—ç—à–±—ç–∫¬ª",
        "–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞": "–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ¬´–¢–≤–æ–π –∫—ç—à–±—ç–∫¬ª"
    }
    
    if product in generic_to_specific:
        return generic_to_specific[product]
    return product


def explain_recommendation(
    profile: Dict,
    product: str,
    use_cache: bool = True,
    use_yandexgpt: bool = True
) -> str:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞.
    
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ.
    
    :param profile: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    :param product: –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞
    :param use_cache: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
    :param use_yandexgpt: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å YandexGPT (–µ—Å–ª–∏ False, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback)
    :return: –¢–µ–∫—Å—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
    """
    # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø—Ä–æ–¥—É–∫—Ç: –∑–∞–º–µ–Ω—è–µ–º –æ–±—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –ü–°–ë
    normalized_product = _normalize_product_name(product)
    if normalized_product != product:
        print(f"‚ö† –ó–∞–º–µ–Ω–µ–Ω–æ –æ–±—â–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ '{product}' –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –ü–°–ë '{normalized_product}'")
        product = normalized_product
    
    if not use_yandexgpt:
        # Fallback: –ø—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –±–µ–∑ YandexGPT
        print(f"üìù –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ (–±–µ–∑ YandexGPT)")
        return _get_fallback_explanation(profile, product, use_cache, None)
    
    try:
        return explain_with_yandexgpt(profile, product, use_cache=use_cache)
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ YandexGPT: {e}")
        # Fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
        return _get_fallback_explanation(profile, product, use_cache, None)


def clear_cache() -> None:
    """–û—á–∏—â–∞–µ—Ç –∫—ç—à –æ–±—ä—è—Å–Ω–µ–Ω–∏–π."""
    global _explanation_cache
    _explanation_cache.clear()

